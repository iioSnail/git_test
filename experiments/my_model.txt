模型：MacBert, 使用macbert作为backbone，macbert的head。加入了FocalLoss中的难易样本的权重。使用了orthogonal_初始化head，其中参数为gain=1。对输出进行了改造，如果该字没错，则固定输出的softmax的index为1，否则softmax就正常输出所在的index。bert的输出融合了一开始的embedding数据，即last_hidden_state += token_embeddings。对token_embedding增加了遗忘门后再加，遗忘门权重只使用了token_emebdding来计算。
执行情况：平均5分钟一个epoch，最后loss还在下降，感觉可以到86%。
2023-04-06 02:03:53,513 - NumExpr defaulting to 2 threads.
Epoch 0 Training: 100% 250/250 [03:45<00:00,  1.11it/s, loss=0.0944, c_precision=0.985, c_recall=0.266, c_f1_score=0.418]
Epoch 0 Validation: 100% 62/62 [00:29<00:00,  2.08it/s, loss=0.0487, c_precision=0.972, c_recall=0.292, c_f1_score=0.449]
2023-04-06 02:08:33,444 - Correction Precision: 0.9723889555810655, Recall: 0.291786743515745, F1-Score: 0.44887780513096
Epoch 1 Training: 100% 250/250 [03:58<00:00,  1.05it/s, loss=0.0791, c_precision=0.961, c_recall=0.411, c_f1_score=0.576]
Epoch 1 Validation: 100% 62/62 [00:28<00:00,  2.14it/s, loss=0.0371, c_precision=0.966, c_recall=0.436, c_f1_score=0.6]
2023-04-06 02:13:51,640 - Correction Precision: 0.965654952075906, Recall: 0.43551873198831575, F1-Score: 0.6002979141690922
Epoch 2 Training: 100% 250/250 [03:55<00:00,  1.06it/s, loss=0.0574, c_precision=0.958, c_recall=0.503, c_f1_score=0.66]
Epoch 2 Validation: 100% 62/62 [00:29<00:00,  2.10it/s, loss=0.0287, c_precision=0.957, c_recall=0.522, c_f1_score=0.676]
2023-04-06 02:18:29,626 - Correction Precision: 0.9570673712014814, Recall: 0.5219740634003883, F1-Score: 0.6755244750674293
Epoch 3 Training: 100% 250/250 [03:55<00:00,  1.06it/s, loss=0.0347, c_precision=0.948, c_recall=0.536, c_f1_score=0.684]
Epoch 3 Validation: 100% 62/62 [00:30<00:00,  2.06it/s, loss=0.0257, c_precision=0.933, c_recall=0.597, c_f1_score=0.728]
2023-04-06 02:23:08,976 - Correction Precision: 0.9329577464783476, Recall: 0.5965417867433009, F1-Score: 0.7277521419101581
Epoch 4 Training: 100% 250/250 [03:55<00:00,  1.06it/s, loss=0.0388, c_precision=0.949, c_recall=0.627, c_f1_score=0.755]
Epoch 4 Validation: 100% 62/62 [00:29<00:00,  2.11it/s, loss=0.021, c_precision=0.952, c_recall=0.624, c_f1_score=0.754]
2023-04-06 02:27:47,488 - Correction Precision: 0.9521452145209284, Recall: 0.6235590778095736, F1-Score: 0.7535916407926382
Epoch 5 Training: 100% 250/250 [03:58<00:00,  1.05it/s, loss=0.0372, c_precision=0.944, c_recall=0.639, c_f1_score=0.762]
Epoch 5 Validation: 100% 62/62 [00:29<00:00,  2.11it/s, loss=0.0204, c_precision=0.958, c_recall=0.637, c_f1_score=0.765]
2023-04-06 02:32:28,736 - Correction Precision: 0.9582429501079403, Recall: 0.6365273775213846, F1-Score: 0.7649350644550815
Epoch 6 Training: 100% 250/250 [03:58<00:00,  1.05it/s, loss=0.0267, c_precision=0.951, c_recall=0.662, c_f1_score=0.781]
Epoch 6 Validation: 100% 62/62 [00:29<00:00,  2.09it/s, loss=0.0169, c_precision=0.936, c_recall=0.686, c_f1_score=0.791]
2023-04-06 02:37:10,119 - Correction Precision: 0.9360550909980639, Recall: 0.6855187319882257, F1-Score: 0.7914327298089654
Epoch 7 Training: 100% 250/250 [03:54<00:00,  1.06it/s, loss=0.0245, c_precision=0.94, c_recall=0.672, c_f1_score=0.784]
Epoch 7 Validation: 100% 62/62 [00:29<00:00,  2.10it/s, loss=0.0173, c_precision=0.948, c_recall=0.696, c_f1_score=0.803]
2023-04-06 02:41:47,971 - Correction Precision: 0.9479882237483082, Recall: 0.6959654178671845, F1-Score: 0.8026589110195188
Epoch 8 Training: 100% 250/250 [03:56<00:00,  1.06it/s, loss=0.0259, c_precision=0.946, c_recall=0.691, c_f1_score=0.799]
Epoch 8 Validation: 100% 62/62 [00:28<00:00,  2.17it/s, loss=0.0159, c_precision=0.928, c_recall=0.702, c_f1_score=0.799]
2023-04-06 02:46:26,131 - Correction Precision: 0.927653498333685, Recall: 0.7020893371755396, F1-Score: 0.7992618408051286
Epoch 9 Training: 100% 250/250 [03:55<00:00,  1.06it/s, loss=0.0143, c_precision=0.946, c_recall=0.721, c_f1_score=0.819]
Epoch 9 Validation: 100% 62/62 [00:28<00:00,  2.16it/s, loss=0.0146, c_precision=0.941, c_recall=0.724, c_f1_score=0.818]
2023-04-06 02:51:03,021 - Correction Precision: 0.9409836065569364, Recall: 0.7237031700285578, F1-Score: 0.8181633063703312
Epoch 10 Training: 100% 250/250 [03:50<00:00,  1.08it/s, loss=0.0336, c_precision=0.941, c_recall=0.716, c_f1_score=0.813]
Epoch 10 Validation: 100% 62/62 [00:28<00:00,  2.15it/s, loss=0.0145, c_precision=0.946, c_recall=0.726, c_f1_score=0.822]
2023-04-06 02:55:35,786 - Correction Precision: 0.9455909943710387, Recall: 0.7262247838614099, F1-Score: 0.8215158919288117
Epoch 11 Training: 100% 250/250 [03:54<00:00,  1.07it/s, loss=0.016, c_precision=0.948, c_recall=0.717, c_f1_score=0.817]
Epoch 11 Validation: 100% 62/62 [00:28<00:00,  2.14it/s, loss=0.0127, c_precision=0.943, c_recall=0.743, c_f1_score=0.831]
2023-04-06 03:00:12,574 - Correction Precision: 0.943301326016944, Recall: 0.7431556195962741, F1-Score: 0.831352004342492
Epoch 12 Training: 100% 250/250 [04:00<00:00,  1.04it/s, loss=0.0372, c_precision=0.938, c_recall=0.725, c_f1_score=0.817]
Epoch 12 Validation: 100% 62/62 [00:29<00:00,  2.09it/s, loss=0.0123, c_precision=0.952, c_recall=0.747, c_f1_score=0.837]
2023-04-06 03:04:55,929 - Correction Precision: 0.9518127581455017, Recall: 0.7471181556193274, F1-Score: 0.8371342073777579
Epoch 13 Training: 100% 250/250 [03:58<00:00,  1.05it/s, loss=0.0165, c_precision=0.945, c_recall=0.748, c_f1_score=0.835]
Epoch 13 Validation: 100% 62/62 [00:29<00:00,  2.09it/s, loss=0.0106, c_precision=0.959, c_recall=0.751, c_f1_score=0.842]
2023-04-06 03:09:36,699 - Correction Precision: 0.9586016559333217, Recall: 0.7507204610948305, F1-Score: 0.842020201527257
Epoch 14 Training: 100% 250/250 [03:59<00:00,  1.04it/s, loss=0.00948, c_precision=0.933, c_recall=0.758, c_f1_score=0.837]
Epoch 14 Validation: 100% 62/62 [00:29<00:00,  2.10it/s, loss=0.0114, c_precision=0.952, c_recall=0.767, c_f1_score=0.85]
2023-04-06 03:14:18,784 - Correction Precision: 0.9517426273454193, Recall: 0.7672910662821444, F1-Score: 0.8496210605345361
Epoch 15 Training: 100% 250/250 [03:59<00:00,  1.05it/s, loss=0.0152, c_precision=0.95, c_recall=0.762, c_f1_score=0.846]
Epoch 15 Validation: 100% 62/62 [00:29<00:00,  2.13it/s, loss=0.0116, c_precision=0.952, c_recall=0.76, c_f1_score=0.845]
2023-04-06 03:19:00,009 - Correction Precision: 0.9517148014436139, Recall: 0.759726224783588, F1-Score: 0.8449519225828765
Epoch 16 Training: 100% 250/250 [03:57<00:00,  1.05it/s, loss=0.0124, c_precision=0.941, c_recall=0.761, c_f1_score=0.842]
Epoch 16 Validation: 100% 62/62 [00:28<00:00,  2.15it/s, loss=0.0123, c_precision=0.921, c_recall=0.785, c_f1_score=0.848]
2023-04-06 03:23:39,060 - Correction Precision: 0.9209970426696574, Recall: 0.7853025936596595, F1-Score: 0.8477542285520256
Epoch 17 Training: 100% 250/250 [03:51<00:00,  1.08it/s, loss=0.0137, c_precision=0.945, c_recall=0.78, c_f1_score=0.855]
Epoch 17 Validation: 100% 62/62 [00:28<00:00,  2.14it/s, loss=0.0114, c_precision=0.94, c_recall=0.776, c_f1_score=0.85]
2023-04-06 03:28:13,179 - Correction Precision: 0.9402268760903402, Recall: 0.7762968299709019, F1-Score: 0.8504340957946745
Epoch 18 Training: 100% 250/250 [03:55<00:00,  1.06it/s, loss=0.0113, c_precision=0.95, c_recall=0.783, c_f1_score=0.859]
Epoch 18 Validation: 100% 62/62 [00:29<00:00,  2.12it/s, loss=0.0113, c_precision=0.944, c_recall=0.782, c_f1_score=0.856]
2023-04-06 03:32:51,380 - Correction Precision: 0.944347826086546, Recall: 0.7824207492792571, F1-Score: 0.8557919616790006
Epoch 19 Training: 100% 250/250 [03:56<00:00,  1.06it/s, loss=0.00973, c_precision=0.944, c_recall=0.79, c_f1_score=0.86]
Epoch 19 Validation: 100% 62/62 [00:29<00:00,  2.12it/s, loss=0.00987, c_precision=0.955, c_recall=0.781, c_f1_score=0.86]
2023-04-06 03:37:30,876 - Correction Precision: 0.9550858652571752, Recall: 0.7813400576366062, F1-Score: 0.8595205067366842
Epoch 20 Training: 100% 250/250 [03:45<00:00,  1.11it/s, loss=0.02, c_precision=0.95, c_recall=0.802, c_f1_score=0.87]
Epoch 20 Validation: 100% 62/62 [00:27<00:00,  2.28it/s, loss=0.00986, c_precision=0.954, c_recall=0.78, c_f1_score=0.859]
2023-04-06 07:43:50,171 - Correction Precision: 0.9541850220260114, Recall: 0.7802593659939553, F1-Score: 0.8585017830956507
Epoch 21 Training: 100% 250/250 [03:55<00:00,  1.06it/s, loss=0.00615, c_precision=0.957, c_recall=0.829, c_f1_score=0.889]
Epoch 21 Validation: 100% 62/62 [00:27<00:00,  2.25it/s, loss=0.00983, c_precision=0.954, c_recall=0.782, c_f1_score=0.86]
2023-04-06 07:48:27,351 - Correction Precision: 0.9542857142852949, Recall: 0.7820605187317068, F1-Score: 0.8596317555924821
Epoch 22 Training: 100% 250/250 [03:54<00:00,  1.07it/s, loss=0.0183, c_precision=0.948, c_recall=0.82, c_f1_score=0.88]
Epoch 22 Validation: 100% 62/62 [00:26<00:00,  2.33it/s, loss=0.00948, c_precision=0.952, c_recall=0.79, c_f1_score=0.864]
2023-04-06 07:53:01,884 - Correction Precision: 0.9522362136339765, Recall: 0.7899855907778134, F1-Score: 0.8635558175784205
Epoch 23 Training: 100% 250/250 [03:54<00:00,  1.07it/s, loss=0.00536, c_precision=0.949, c_recall=0.825, c_f1_score=0.883]
Epoch 23 Validation: 100% 62/62 [00:28<00:00,  2.19it/s, loss=0.0106, c_precision=0.947, c_recall=0.796, c_f1_score=0.865]
2023-04-06 07:57:38,668 - Correction Precision: 0.9468495499352992, Recall: 0.7957492795386183, F1-Score: 0.8647484825725145
Epoch 24 Training: 100% 250/250 [03:59<00:00,  1.04it/s, loss=0.01, c_precision=0.954, c_recall=0.84, c_f1_score=0.893]
Epoch 24 Validation: 100% 62/62 [00:27<00:00,  2.29it/s, loss=0.00892, c_precision=0.941, c_recall=0.799, c_f1_score=0.865]
2023-04-06 08:02:18,611 - Correction Precision: 0.9414509970297236, Recall: 0.7993515850141213, F1-Score: 0.8646015970093263
Epoch 25 Training: 100% 250/250 [03:59<00:00,  1.04it/s, loss=0.0105, c_precision=0.954, c_recall=0.836, c_f1_score=0.891]
Epoch 25 Validation: 100% 62/62 [00:26<00:00,  2.31it/s, loss=0.00892, c_precision=0.946, c_recall=0.786, c_f1_score=0.859]
2023-04-06 08:06:58,372 - Correction Precision: 0.9458170784564605, Recall: 0.7860230547547601, F1-Score: 0.8585481010187723
Epoch 26 Training: 100% 250/250 [03:58<00:00,  1.05it/s, loss=0.00812, c_precision=0.957, c_recall=0.825, c_f1_score=0.886]
Epoch 26 Validation: 100% 62/62 [00:28<00:00,  2.20it/s, loss=0.0096, c_precision=0.927, c_recall=0.801, c_f1_score=0.859]
2023-04-06 08:11:38,851 - Correction Precision: 0.9266360983739363, Recall: 0.8007925072043225, F1-Score: 0.8591304342849302
Epoch 27 Training: 100% 250/250 [03:57<00:00,  1.05it/s, loss=0.00821, c_precision=0.953, c_recall=0.833, c_f1_score=0.889]
Epoch 27 Validation: 100% 62/62 [00:27<00:00,  2.26it/s, loss=0.00952, c_precision=0.951, c_recall=0.802, c_f1_score=0.87]
2023-04-06 08:16:17,642 - Correction Precision: 0.9508966695128306, Recall: 0.8022334293945237, F1-Score: 0.8702618205270928
Epoch 28 Training: 100% 250/250 [03:58<00:00,  1.05it/s, loss=0.0119, c_precision=0.957, c_recall=0.849, c_f1_score=0.9]
Epoch 28 Validation: 100% 62/62 [00:26<00:00,  2.35it/s, loss=0.0099, c_precision=0.943, c_recall=0.794, c_f1_score=0.862]
2023-04-06 08:20:56,397 - Correction Precision: 0.9434931506845277, Recall: 0.7939481268008667, F1-Score: 0.8622848195346657
Epoch 29 Training: 100% 250/250 [03:57<00:00,  1.05it/s, loss=0.00623, c_precision=0.959, c_recall=0.843, c_f1_score=0.897]
Epoch 29 Validation: 100% 62/62 [00:28<00:00,  2.21it/s, loss=0.00919, c_precision=0.941, c_recall=0.803, c_f1_score=0.867]
2023-04-06 08:25:36,093 - Correction Precision: 0.9405314213408096, Recall: 0.8033141210371746, F1-Score: 0.8665241883506316
Epoch 30 Training: 100% 250/250 [03:54<00:00,  1.07it/s, loss=0.00847, c_precision=0.96, c_recall=0.854, c_f1_score=0.904]
Epoch 30 Validation: 100% 62/62 [00:27<00:00,  2.29it/s, loss=0.00968, c_precision=0.91, c_recall=0.816, c_f1_score=0.861]
2023-04-06 08:30:11,151 - Correction Precision: 0.9104057854556407, Recall: 0.8162824207489855, F1-Score: 0.8607787269465528
Epoch 31 Training: 100% 250/250 [03:57<00:00,  1.05it/s, loss=0.00848, c_precision=0.954, c_recall=0.831, c_f1_score=0.888]
Epoch 31 Validation: 100% 62/62 [00:27<00:00,  2.22it/s, loss=0.00855, c_precision=0.936, c_recall=0.812, c_f1_score=0.869]
2023-04-06 08:34:49,812 - Correction Precision: 0.9356312292354918, Recall: 0.8115994236308316, F1-Score: 0.8692129624651472
Epoch 32 Training: 100% 250/250 [04:01<00:00,  1.04it/s, loss=0.0167, c_precision=0.956, c_recall=0.85, c_f1_score=0.9]
Epoch 32 Validation: 100% 62/62 [00:27<00:00,  2.28it/s, loss=0.00827, c_precision=0.947, c_recall=0.804, c_f1_score=0.87]
2023-04-06 08:39:31,432 - Correction Precision: 0.9469664828167387, Recall: 0.8040345821322752, F1-Score: 0.8696668609875048
Epoch 33 Training: 100% 250/250 [04:04<00:00,  1.02it/s, loss=0.00477, c_precision=0.958, c_recall=0.861, c_f1_score=0.907]
Epoch 33 Validation: 100% 62/62 [00:28<00:00,  2.16it/s, loss=0.00779, c_precision=0.939, c_recall=0.809, c_f1_score=0.87]
2023-04-06 08:44:17,834 - Correction Precision: 0.9393812709026174, Recall: 0.8094380403455298, F1-Score: 0.8695820428460772
Epoch 34 Training: 100% 250/250 [04:07<00:00,  1.01it/s, loss=0.00292, c_precision=0.96, c_recall=0.865, c_f1_score=0.91]
Epoch 34 Validation: 100% 62/62 [00:28<00:00,  2.17it/s, loss=0.00845, c_precision=0.953, c_recall=0.811, c_f1_score=0.876]
2023-04-06 08:49:06,962 - Correction Precision: 0.9533898305080706, Recall: 0.8105187319881807, F1-Score: 0.8761682238020045
Epoch 35 Training: 100% 250/250 [04:06<00:00,  1.01it/s, loss=0.00462, c_precision=0.961, c_recall=0.867, c_f1_score=0.912]
Epoch 35 Validation: 100% 62/62 [00:28<00:00,  2.15it/s, loss=0.00844, c_precision=0.948, c_recall=0.809, c_f1_score=0.873]
2023-04-06 08:53:56,341 - Correction Precision: 0.9481012658223847, Recall: 0.8094380403455298, F1-Score: 0.8732996497165312
Epoch 36 Training: 100% 250/250 [04:06<00:00,  1.02it/s, loss=0.00438, c_precision=0.964, c_recall=0.862, c_f1_score=0.91]
Epoch 36 Validation: 100% 62/62 [00:28<00:00,  2.18it/s, loss=0.00889, c_precision=0.929, c_recall=0.82, c_f1_score=0.871]
2023-04-06 08:58:44,316 - Correction Precision: 0.92895059207802, Recall: 0.8195244956769382, F1-Score: 0.8708133966308116
Epoch 37 Training: 100% 250/250 [04:04<00:00,  1.02it/s, loss=0.00861, c_precision=0.958, c_recall=0.864, c_f1_score=0.909]
Epoch 37 Validation: 100% 62/62 [00:28<00:00,  2.15it/s, loss=0.00897, c_precision=0.945, c_recall=0.816, c_f1_score=0.876]
2023-04-06 09:03:31,416 - Correction Precision: 0.9453483521064058, Recall: 0.8162824207489855, F1-Score: 0.8760873762663118
Epoch 38 Training: 100% 250/250 [04:10<00:00,  1.00s/it, loss=0.00843, c_precision=0.958, c_recall=0.861, c_f1_score=0.907]
Epoch 38 Validation: 100% 62/62 [00:28<00:00,  2.15it/s, loss=0.0085, c_precision=0.938, c_recall=0.818, c_f1_score=0.874]
2023-04-06 09:08:24,019 - Correction Precision: 0.9376548307180274, Recall: 0.818083573486737, F1-Score: 0.8737976139690855
Epoch 39 Training: 100% 250/250 [04:10<00:00,  1.00s/it, loss=0.00641, c_precision=0.956, c_recall=0.865, c_f1_score=0.908]
Epoch 39 Validation: 100% 62/62 [00:28<00:00,  2.18it/s, loss=0.0089, c_precision=0.949, c_recall=0.809, c_f1_score=0.874]
2023-04-06 09:13:15,982 - Correction Precision: 0.9489020270266263, Recall: 0.8094380403455298, F1-Score: 0.8736391907936302
Eval情况：居然超过了之前所有的情况。到底怎么回事，bug？还是pytorch lightning确实牛逼，或者说MultiModalBert其反作用？
Character-level Detect Acc: 0.9854, P: 0.6273, R: 0.7397, F1: 0.6789
Character-level Correct Acc: 0.9847, P: 0.6166, R: 0.7070, F1: 0.6587
Sentence-level Detect Acc: 0.6609, P: 0.6803, R: 0.5860, F1: 0.6296
Sentence-level Correct Acc: 0.6509, P: 0.6725, R: 0.5656, F1: 0.6145


模型：MacBert, 使用macbert作为backbone，macbert的head。加入了FocalLoss中的难易样本的权重。使用了orthogonal_初始化head，其中参数为gain=1。对输出进行了改造，如果该字没错，则固定输出的softmax的index为1，否则softmax就正常输出所在的index。bert的输出融合了一开始的embedding数据，即last_hidden_state += token_embeddings。对token_embedding增加了遗忘门后再加，遗忘门权重只使用了token_emebdding来计算。
使用bf16混合精度
执行情况：每4分钟1个epoch，速度还是有提升的。而且性能也没有下降太多。
2023-04-06 09:50:17,710 - NumExpr defaulting to 2 threads.
Epoch 0 Training: 100% 250/250 [02:28<00:00,  1.68it/s, loss=0.0957, c_precision=0.982, c_recall=0.263, c_f1_score=0.415]
Epoch 0 Validation: 100% 62/62 [00:21<00:00,  2.86it/s, loss=0.0794, c_precision=0.973, c_recall=0.294, c_f1_score=0.451]
2023-04-06 09:53:36,479 - Correction Precision: 0.972553699282849, Recall: 0.29358789625349657, F1-Score: 0.4510237959910687
Epoch 1 Training: 100% 250/250 [02:45<00:00,  1.51it/s, loss=0.079, c_precision=0.963, c_recall=0.414, c_f1_score=0.579]
Epoch 1 Validation: 100% 62/62 [00:22<00:00,  2.70it/s, loss=0.0582, c_precision=0.963, c_recall=0.436, c_f1_score=0.6]
2023-04-06 09:57:22,630 - Correction Precision: 0.962609387429624, Recall: 0.43587896253586605, F1-Score: 0.6000495904459112
Epoch 2 Training: 100% 250/250 [02:46<00:00,  1.50it/s, loss=0.0565, c_precision=0.959, c_recall=0.5, c_f1_score=0.657]
Epoch 2 Validation: 100% 62/62 [00:24<00:00,  2.53it/s, loss=0.0457, c_precision=0.955, c_recall=0.526, c_f1_score=0.678]
2023-04-06 10:00:54,561 - Correction Precision: 0.9554682383752747, Recall: 0.5255763688758913, F1-Score: 0.6781315356793894
Epoch 3 Training: 100% 250/250 [02:44<00:00,  1.52it/s, loss=0.0354, c_precision=0.948, c_recall=0.546, c_f1_score=0.693]
Epoch 3 Validation: 100% 62/62 [00:24<00:00,  2.53it/s, loss=0.0389, c_precision=0.931, c_recall=0.594, c_f1_score=0.725]
2023-04-06 10:04:24,417 - Correction Precision: 0.9311123658944488, Recall: 0.5940201729104488, F1-Score: 0.725313392970335
Epoch 4 Training: 100% 250/250 [02:47<00:00,  1.49it/s, loss=0.0408, c_precision=0.948, c_recall=0.633, c_f1_score=0.759]
Epoch 4 Validation: 100% 62/62 [00:24<00:00,  2.54it/s, loss=0.0341, c_precision=0.957, c_recall=0.618, c_f1_score=0.751]
2023-04-06 10:07:56,792 - Correction Precision: 0.957031249999466, Recall: 0.6177953890487689, F1-Score: 0.7508756562654293
Epoch 5 Training: 100% 250/250 [02:53<00:00,  1.44it/s, loss=0.0354, c_precision=0.942, c_recall=0.647, c_f1_score=0.767]
Epoch 5 Validation: 100% 62/62 [00:22<00:00,  2.70it/s, loss=0.0311, c_precision=0.943, c_recall=0.647, c_f1_score=0.767]
2023-04-06 10:11:33,645 - Correction Precision: 0.9427821522304762, Recall: 0.6469740634003434, F1-Score: 0.7673574017814567
Epoch 6 Training: 100% 250/250 [02:53<00:00,  1.44it/s, loss=0.0261, c_precision=0.949, c_recall=0.658, c_f1_score=0.777]
Epoch 6 Validation: 100% 62/62 [00:23<00:00,  2.62it/s, loss=0.0284, c_precision=0.936, c_recall=0.68, c_f1_score=0.788]
2023-04-06 10:15:11,997 - Correction Precision: 0.9364764267985427, Recall: 0.6797550432274209, F1-Score: 0.7877269876149787
Epoch 7 Training: 100% 250/250 [02:50<00:00,  1.47it/s, loss=0.0238, c_precision=0.941, c_recall=0.676, c_f1_score=0.787]
Epoch 7 Validation: 100% 62/62 [00:24<00:00,  2.54it/s, loss=0.0263, c_precision=0.948, c_recall=0.691, c_f1_score=0.799]
2023-04-06 10:18:49,241 - Correction Precision: 0.9476284584975555, Recall: 0.6909221902014803, F1-Score: 0.7991666661786059
Epoch 8 Training: 100% 250/250 [02:51<00:00,  1.46it/s, loss=0.027, c_precision=0.94, c_recall=0.691, c_f1_score=0.797]
Epoch 8 Validation: 100% 62/62 [00:23<00:00,  2.59it/s, loss=0.0248, c_precision=0.927, c_recall=0.706, c_f1_score=0.801]
2023-04-06 10:22:25,905 - Correction Precision: 0.9267139479901055, Recall: 0.706051873198593, F1-Score: 0.801472091105615
Epoch 9 Training: 100% 250/250 [02:50<00:00,  1.47it/s, loss=0.0151, c_precision=0.945, c_recall=0.717, c_f1_score=0.815]
Epoch 9 Validation: 100% 62/62 [00:23<00:00,  2.62it/s, loss=0.0236, c_precision=0.95, c_recall=0.72, c_f1_score=0.819]
2023-04-06 10:26:01,756 - Correction Precision: 0.9496197718626666, Recall: 0.7197406340055044, F1-Score: 0.8188524585255392
Epoch 10 Training: 100% 250/250 [02:46<00:00,  1.50it/s, loss=0.036, c_precision=0.949, c_recall=0.726, c_f1_score=0.822]
Epoch 10 Validation: 100% 62/62 [00:22<00:00,  2.76it/s, loss=0.0223, c_precision=0.94, c_recall=0.734, c_f1_score=0.824]
2023-04-06 10:29:32,336 - Correction Precision: 0.9400092293488971, Recall: 0.7337896253599662, F1-Score: 0.8241958319976465
Epoch 11 Training: 100% 250/250 [02:46<00:00,  1.50it/s, loss=0.0166, c_precision=0.945, c_recall=0.717, c_f1_score=0.816]
Epoch 11 Validation: 100% 62/62 [00:21<00:00,  2.84it/s, loss=0.0212, c_precision=0.943, c_recall=0.745, c_f1_score=0.832]
2023-04-06 10:33:02,264 - Correction Precision: 0.9425706472192604, Recall: 0.7449567723340256, F1-Score: 0.8321931584602439
Epoch 12 Training: 100% 250/250 [02:53<00:00,  1.44it/s, loss=0.0377, c_precision=0.944, c_recall=0.729, c_f1_score=0.823]
Epoch 12 Validation: 100% 62/62 [00:23<00:00,  2.67it/s, loss=0.0204, c_precision=0.946, c_recall=0.746, c_f1_score=0.834]
2023-04-06 10:36:39,254 - Correction Precision: 0.9460941068976948, Recall: 0.7460374639766765, F1-Score: 0.8342396772508623
Epoch 13 Training: 100% 250/250 [02:48<00:00,  1.49it/s, loss=0.0173, c_precision=0.952, c_recall=0.752, c_f1_score=0.84]
Epoch 13 Validation: 100% 62/62 [00:24<00:00,  2.56it/s, loss=0.0197, c_precision=0.958, c_recall=0.75, c_f1_score=0.842]
2023-04-06 10:40:12,979 - Correction Precision: 0.9581416743325859, Recall: 0.7503602305472802, F1-Score: 0.8416161611232168
Epoch 14 Training: 100% 250/250 [02:51<00:00,  1.46it/s, loss=0.00847, c_precision=0.938, c_recall=0.758, c_f1_score=0.838]
Epoch 14 Validation: 100% 62/62 [00:23<00:00,  2.65it/s, loss=0.019, c_precision=0.962, c_recall=0.753, c_f1_score=0.845]
2023-04-06 10:43:49,579 - Correction Precision: 0.9622641509429534, Recall: 0.7532420749276826, F1-Score: 0.845019195304212
Epoch 15 Training: 100% 250/250 [02:49<00:00,  1.47it/s, loss=0.0131, c_precision=0.949, c_recall=0.764, c_f1_score=0.846]
Epoch 15 Validation: 100% 62/62 [00:23<00:00,  2.67it/s, loss=0.0188, c_precision=0.944, c_recall=0.768, c_f1_score=0.847]
2023-04-06 10:47:24,250 - Correction Precision: 0.9442231075693032, Recall: 0.7683717579247953, F1-Score: 0.8472691156916283
Epoch 16 Training: 100% 250/250 [02:49<00:00,  1.48it/s, loss=0.0103, c_precision=0.945, c_recall=0.773, c_f1_score=0.851]
Epoch 16 Validation: 100% 62/62 [00:21<00:00,  2.87it/s, loss=0.0183, c_precision=0.925, c_recall=0.778, c_f1_score=0.845]
2023-04-06 10:50:56,786 - Correction Precision: 0.925021422450332, Recall: 0.7777377521611031, F1-Score: 0.8450097842392222
Epoch 17 Training: 100% 250/250 [02:48<00:00,  1.48it/s, loss=0.0133, c_precision=0.948, c_recall=0.778, c_f1_score=0.854]
Epoch 17 Validation: 100% 62/62 [00:22<00:00,  2.75it/s, loss=0.0176, c_precision=0.944, c_recall=0.778, c_f1_score=0.853]
2023-04-06 10:54:28,637 - Correction Precision: 0.9436435124504396, Recall: 0.7780979827086534, F1-Score: 0.8529121416563092
Epoch 18 Training: 100% 250/250 [02:51<00:00,  1.46it/s, loss=0.0108, c_precision=0.949, c_recall=0.778, c_f1_score=0.855]
Epoch 18 Validation: 100% 62/62 [00:24<00:00,  2.52it/s, loss=0.0171, c_precision=0.942, c_recall=0.78, c_f1_score=0.853]
2023-04-06 10:58:05,293 - Correction Precision: 0.9417137886033311, Recall: 0.779899135446405, F1-Score: 0.8532019699474306
Epoch 19 Training: 100% 250/250 [02:50<00:00,  1.46it/s, loss=0.0116, c_precision=0.951, c_recall=0.776, c_f1_score=0.854]
Epoch 19 Validation: 100% 62/62 [00:24<00:00,  2.57it/s, loss=0.0168, c_precision=0.945, c_recall=0.78, c_f1_score=0.855]
2023-04-06 11:01:42,221 - Correction Precision: 0.9450021824526648, Recall: 0.779899135446405, F1-Score: 0.8545490423303734
Epoch 20 Training: 100% 250/250 [02:49<00:00,  1.48it/s, loss=0.017, c_precision=0.947, c_recall=0.799, c_f1_score=0.867]
Epoch 20 Validation: 100% 62/62 [00:23<00:00,  2.66it/s, loss=0.0167, c_precision=0.96, c_recall=0.769, c_f1_score=0.854]
2023-04-06 11:05:15,855 - Correction Precision: 0.9595687331532078, Recall: 0.7694524495674462, F1-Score: 0.8540583761550439
Epoch 21 Training: 100% 250/250 [02:48<00:00,  1.48it/s, loss=0.00942, c_precision=0.951, c_recall=0.796, c_f1_score=0.867]
Epoch 21 Validation: 100% 62/62 [00:21<00:00,  2.90it/s, loss=0.0161, c_precision=0.946, c_recall=0.794, c_f1_score=0.863]
2023-04-06 11:08:47,029 - Correction Precision: 0.9463058419239921, Recall: 0.7935878962533164, F1-Score: 0.8632445136100969

模型：MacBert, 使用macbert作为backbone，macbert的head。加入了FocalLoss中的难易样本的权重。使用了orthogonal_初始化head，其中参数为gain=1。对输出进行了改造，如果该字没错，则固定输出的softmax的index为1，否则softmax就正常输出所在的index。bert的输出融合了一开始的embedding数据，即last_hidden_state += token_embeddings。对token_embedding增加了遗忘门后再加，遗忘门权重只使用了token_emebdding来计算。使用bf16混合精度
增加了SWA。StochasticWeightAveraging(swa_lrs=2e-5, swa_epoch_start=10)
执行情况：居然到了88.65，有点吊
2023-04-07 03:05:17,662 - NumExpr defaulting to 2 threads.
Epoch 0 Training: 100% 250/250 [02:22<00:00,  1.76it/s, loss=0.0957, c_precision=0.982, c_recall=0.263, c_f1_score=0.415]
Epoch 0 Validation: 100% 62/62 [00:21<00:00,  2.89it/s, loss=0.0794, c_precision=0.973, c_recall=0.294, c_f1_score=0.451]
2023-04-07 03:08:28,106 - Correction Precision: 0.972553699282849, Recall: 0.29358789625349657, F1-Score: 0.4510237959910687
Epoch 1 Training: 100% 250/250 [02:41<00:00,  1.55it/s, loss=0.079, c_precision=0.963, c_recall=0.414, c_f1_score=0.579]
Epoch 1 Validation: 100% 62/62 [00:21<00:00,  2.87it/s, loss=0.0582, c_precision=0.963, c_recall=0.436, c_f1_score=0.6]
2023-04-07 03:12:38,443 - Correction Precision: 0.962609387429624, Recall: 0.43587896253586605, F1-Score: 0.6000495904459112
Epoch 2 Training: 100% 250/250 [02:41<00:00,  1.54it/s, loss=0.0565, c_precision=0.959, c_recall=0.5, c_f1_score=0.657]
Epoch 2 Validation: 100% 62/62 [00:21<00:00,  2.87it/s, loss=0.0457, c_precision=0.955, c_recall=0.526, c_f1_score=0.678]
2023-04-07 03:16:08,636 - Correction Precision: 0.9554682383752747, Recall: 0.5255763688758913, F1-Score: 0.6781315356793894
Epoch 3 Training: 100% 250/250 [02:43<00:00,  1.53it/s, loss=0.0354, c_precision=0.948, c_recall=0.546, c_f1_score=0.693]
Epoch 3 Validation: 100% 62/62 [00:23<00:00,  2.66it/s, loss=0.0389, c_precision=0.931, c_recall=0.594, c_f1_score=0.725]
2023-04-07 03:19:43,585 - Correction Precision: 0.9311123658944488, Recall: 0.5940201729104488, F1-Score: 0.725313392970335
Epoch 4 Training: 100% 250/250 [02:42<00:00,  1.54it/s, loss=0.0408, c_precision=0.948, c_recall=0.633, c_f1_score=0.759]
Epoch 4 Validation: 100% 62/62 [00:22<00:00,  2.70it/s, loss=0.0341, c_precision=0.957, c_recall=0.618, c_f1_score=0.751]
2023-04-07 03:23:15,987 - Correction Precision: 0.957031249999466, Recall: 0.6177953890487689, F1-Score: 0.7508756562654293
Epoch 5 Training: 100% 250/250 [02:43<00:00,  1.53it/s, loss=0.0354, c_precision=0.942, c_recall=0.647, c_f1_score=0.767]
Epoch 5 Validation: 100% 62/62 [00:22<00:00,  2.78it/s, loss=0.0311, c_precision=0.943, c_recall=0.647, c_f1_score=0.767]
2023-04-07 03:26:48,982 - Correction Precision: 0.9427821522304762, Recall: 0.6469740634003434, F1-Score: 0.7673574017814567
Epoch 6 Training: 100% 250/250 [02:43<00:00,  1.53it/s, loss=0.0261, c_precision=0.949, c_recall=0.658, c_f1_score=0.777]
Epoch 6 Validation: 100% 62/62 [00:21<00:00,  2.91it/s, loss=0.0284, c_precision=0.936, c_recall=0.68, c_f1_score=0.788]
2023-04-07 03:30:21,304 - Correction Precision: 0.9364764267985427, Recall: 0.6797550432274209, F1-Score: 0.7877269876149787
Epoch 7 Training: 100% 250/250 [02:40<00:00,  1.56it/s, loss=0.0238, c_precision=0.941, c_recall=0.676, c_f1_score=0.787]
Epoch 7 Validation: 100% 62/62 [00:21<00:00,  2.87it/s, loss=0.0263, c_precision=0.948, c_recall=0.691, c_f1_score=0.799]
2023-04-07 03:33:51,433 - Correction Precision: 0.9476284584975555, Recall: 0.6909221902014803, F1-Score: 0.7991666661786059
Epoch 8 Training: 100% 250/250 [02:41<00:00,  1.54it/s, loss=0.027, c_precision=0.94, c_recall=0.691, c_f1_score=0.797]
Epoch 8 Validation: 100% 62/62 [00:20<00:00,  2.97it/s, loss=0.0248, c_precision=0.927, c_recall=0.706, c_f1_score=0.801]
2023-04-07 03:37:22,220 - Correction Precision: 0.9267139479901055, Recall: 0.706051873198593, F1-Score: 0.801472091105615
Epoch 9 Training:   0% 0/250 [00:00<?, ?it/s]Swapping scheduler `PlateauScheduler` for `SWALR`
Epoch 9 Training: 100% 250/250 [02:41<00:00,  1.55it/s, loss=0.0151, c_precision=0.945, c_recall=0.717, c_f1_score=0.815]
Epoch 9 Validation: 100% 62/62 [00:21<00:00,  2.85it/s, loss=0.0236, c_precision=0.95, c_recall=0.72, c_f1_score=0.819]
2023-04-07 03:40:53,433 - Correction Precision: 0.9496197718626666, Recall: 0.7197406340055044, F1-Score: 0.8188524585255392
Epoch 10 Training: 100% 250/250 [02:37<00:00,  1.59it/s, loss=0.0359, c_precision=0.949, c_recall=0.725, c_f1_score=0.822]
Epoch 10 Validation: 100% 62/62 [00:20<00:00,  3.02it/s, loss=0.0223, c_precision=0.94, c_recall=0.734, c_f1_score=0.824]
2023-04-07 03:44:18,925 - Correction Precision: 0.9400369003685701, Recall: 0.7341498559075165, F1-Score: 0.8244336564651569
Epoch 11 Training: 100% 250/250 [02:43<00:00,  1.53it/s, loss=0.0166, c_precision=0.946, c_recall=0.717, c_f1_score=0.816]
Epoch 11 Validation: 100% 62/62 [00:21<00:00,  2.94it/s, loss=0.0212, c_precision=0.944, c_recall=0.747, c_f1_score=0.834]
2023-04-07 03:47:49,934 - Correction Precision: 0.9436107321505486, Recall: 0.7474783861668777, F1-Score: 0.8341708537777469
Epoch 12 Training: 100% 250/250 [02:47<00:00,  1.50it/s, loss=0.0377, c_precision=0.947, c_recall=0.728, c_f1_score=0.823]
Epoch 12 Validation: 100% 62/62 [00:22<00:00,  2.74it/s, loss=0.0202, c_precision=0.95, c_recall=0.745, c_f1_score=0.835]
2023-04-07 03:51:26,983 - Correction Precision: 0.9499540863172865, Recall: 0.7453170028815759, F1-Score: 0.8352846179970572
Epoch 13 Training: 100% 250/250 [02:43<00:00,  1.53it/s, loss=0.0172, c_precision=0.96, c_recall=0.755, c_f1_score=0.845]
Epoch 13 Validation: 100% 62/62 [00:21<00:00,  2.84it/s, loss=0.0195, c_precision=0.958, c_recall=0.754, c_f1_score=0.844]
2023-04-07 03:54:59,853 - Correction Precision: 0.9578947368416669, Recall: 0.7539625360227832, F1-Score: 0.8437814951729521
Epoch 14 Training: 100% 250/250 [02:45<00:00,  1.51it/s, loss=0.00813, c_precision=0.951, c_recall=0.766, c_f1_score=0.848]
Epoch 14 Validation: 100% 62/62 [00:21<00:00,  2.86it/s, loss=0.0188, c_precision=0.962, c_recall=0.76, c_f1_score=0.849]
2023-04-07 03:58:34,311 - Correction Precision: 0.9617312072888557, Recall: 0.7604466858786886, F1-Score: 0.8493260908362008
Epoch 15 Training: 100% 250/250 [02:46<00:00,  1.50it/s, loss=0.0135, c_precision=0.954, c_recall=0.77, c_f1_score=0.852]
Epoch 15 Validation: 100% 62/62 [00:23<00:00,  2.67it/s, loss=0.0184, c_precision=0.954, c_recall=0.777, c_f1_score=0.856]
2023-04-07 04:02:12,065 - Correction Precision: 0.9539823008845336, Recall: 0.7766570605184522, F1-Score: 0.8562351067328678
Epoch 16 Training: 100% 250/250 [02:45<00:00,  1.51it/s, loss=0.0117, c_precision=0.956, c_recall=0.774, c_f1_score=0.855]
Epoch 16 Validation: 100% 62/62 [00:20<00:00,  2.99it/s, loss=0.018, c_precision=0.949, c_recall=0.784, c_f1_score=0.859]
2023-04-07 04:05:45,994 - Correction Precision: 0.9485838779952294, Recall: 0.7842219020170086, F1-Score: 0.8586077691748364
Epoch 17 Training: 100% 250/250 [02:43<00:00,  1.53it/s, loss=0.0121, c_precision=0.964, c_recall=0.789, c_f1_score=0.868]
Epoch 17 Validation: 100% 62/62 [00:21<00:00,  2.88it/s, loss=0.0176, c_precision=0.951, c_recall=0.79, c_f1_score=0.863]
2023-04-07 04:09:17,566 - Correction Precision: 0.9505851755522537, Recall: 0.7899855907778134, F1-Score: 0.8628762536845191
Epoch 18 Training: 100% 250/250 [02:46<00:00,  1.50it/s, loss=0.0104, c_precision=0.964, c_recall=0.78, c_f1_score=0.862]
Epoch 18 Validation: 100% 62/62 [00:22<00:00,  2.79it/s, loss=0.0173, c_precision=0.956, c_recall=0.783, c_f1_score=0.861]
2023-04-07 04:12:54,006 - Correction Precision: 0.9564260563376072, Recall: 0.7827809798268074, F1-Score: 0.8609350232764339
Epoch 19 Training: 100% 250/250 [02:44<00:00,  1.52it/s, loss=0.011, c_precision=0.972, c_recall=0.79, c_f1_score=0.871]
Epoch 19 Validation: 100% 62/62 [00:22<00:00,  2.76it/s, loss=0.0172, c_precision=0.961, c_recall=0.776, c_f1_score=0.858]
2023-04-07 04:16:28,728 - Correction Precision: 0.9607318161530742, Recall: 0.7755763688758013, F1-Score: 0.8582818412434341
Epoch 20 Training: 100% 250/250 [02:44<00:00,  1.52it/s, loss=0.0152, c_precision=0.968, c_recall=0.805, c_f1_score=0.879]
Epoch 20 Validation: 100% 62/62 [00:21<00:00,  2.92it/s, loss=0.017, c_precision=0.967, c_recall=0.772, c_f1_score=0.859]
2023-04-07 04:20:02,229 - Correction Precision: 0.9674943566587054, Recall: 0.7719740634002983, F1-Score: 0.8587457418421782
Epoch 21 Training: 100% 250/250 [02:43<00:00,  1.53it/s, loss=0.0117, c_precision=0.967, c_recall=0.805, c_f1_score=0.879]
Epoch 21 Validation: 100% 62/62 [00:20<00:00,  2.96it/s, loss=0.0167, c_precision=0.959, c_recall=0.79, c_f1_score=0.866]
2023-04-07 04:23:33,555 - Correction Precision: 0.958898119807189, Recall: 0.7899855907778134, F1-Score: 0.8662848108809761
Epoch 22 Training: 100% 250/250 [02:45<00:00,  1.51it/s, loss=0.0147, c_precision=0.971, c_recall=0.793, c_f1_score=0.873]
Epoch 22 Validation: 100% 62/62 [00:20<00:00,  2.97it/s, loss=0.0164, c_precision=0.962, c_recall=0.796, c_f1_score=0.871]
2023-04-07 04:27:06,884 - Correction Precision: 0.9617058311571098, Recall: 0.7961095100861686, F1-Score: 0.8711076069144212
Epoch 23 Training: 100% 250/250 [02:46<00:00,  1.51it/s, loss=0.0125, c_precision=0.964, c_recall=0.824, c_f1_score=0.888]
Epoch 23 Validation: 100% 62/62 [00:23<00:00,  2.65it/s, loss=0.0162, c_precision=0.966, c_recall=0.799, c_f1_score=0.875]
2023-04-07 04:30:44,552 - Correction Precision: 0.9664341761111742, Recall: 0.7986311239190207, F1-Score: 0.8745562125219256
Epoch 24 Training: 100% 250/250 [02:42<00:00,  1.53it/s, loss=0.0102, c_precision=0.966, c_recall=0.805, c_f1_score=0.878]
Epoch 24 Validation: 100% 62/62 [00:22<00:00,  2.78it/s, loss=0.0161, c_precision=0.964, c_recall=0.793, c_f1_score=0.87]
2023-04-07 04:34:17,506 - Correction Precision: 0.9636761487960772, Recall: 0.7932276657057661, F1-Score: 0.8701837576549253
Epoch 25 Training: 100% 250/250 [02:46<00:00,  1.50it/s, loss=0.0108, c_precision=0.967, c_recall=0.819, c_f1_score=0.887]
Epoch 25 Validation: 100% 62/62 [00:20<00:00,  2.96it/s, loss=0.0159, c_precision=0.969, c_recall=0.787, c_f1_score=0.869]
2023-04-07 04:37:52,591 - Correction Precision: 0.968957871396466, Recall: 0.787103746397411, F1-Score: 0.8686145890498388
Epoch 26 Training: 100% 250/250 [02:47<00:00,  1.50it/s, loss=0.00884, c_precision=0.974, c_recall=0.827, c_f1_score=0.895]
Epoch 26 Validation: 100% 62/62 [00:22<00:00,  2.78it/s, loss=0.0158, c_precision=0.961, c_recall=0.797, c_f1_score=0.871]
2023-04-07 04:41:29,269 - Correction Precision: 0.9609035621194784, Recall: 0.7968299711812692, F1-Score: 0.8712091369597047
Epoch 27 Training: 100% 250/250 [02:46<00:00,  1.50it/s, loss=0.00374, c_precision=0.976, c_recall=0.824, c_f1_score=0.893]
Epoch 27 Validation: 100% 62/62 [00:21<00:00,  2.82it/s, loss=0.0158, c_precision=0.962, c_recall=0.802, c_f1_score=0.874]
2023-04-07 04:45:06,135 - Correction Precision: 0.9619541720704877, Recall: 0.8015129682994231, F1-Score: 0.8744350555069391
Epoch 28 Training: 100% 250/250 [02:45<00:00,  1.51it/s, loss=0.0181, c_precision=0.976, c_recall=0.832, c_f1_score=0.899]
Epoch 28 Validation: 100% 62/62 [00:21<00:00,  2.85it/s, loss=0.0154, c_precision=0.964, c_recall=0.804, c_f1_score=0.877]
2023-04-07 04:48:40,179 - Correction Precision: 0.9641623488769585, Recall: 0.8043948126798255, F1-Score: 0.8770620576341366
Epoch 29 Training: 100% 250/250 [02:48<00:00,  1.48it/s, loss=0.00953, c_precision=0.968, c_recall=0.821, c_f1_score=0.888]
Epoch 29 Validation: 100% 62/62 [00:22<00:00,  2.79it/s, loss=0.0153, c_precision=0.965, c_recall=0.803, c_f1_score=0.877]
2023-04-07 04:52:18,960 - Correction Precision: 0.9653679653675474, Recall: 0.8033141210371746, F1-Score: 0.8769170266371596
Epoch 30 Training: 100% 250/250 [02:49<00:00,  1.48it/s, loss=0.00806, c_precision=0.976, c_recall=0.822, c_f1_score=0.892]
Epoch 30 Validation: 100% 62/62 [00:22<00:00,  2.74it/s, loss=0.0152, c_precision=0.96, c_recall=0.807, c_f1_score=0.877]
2023-04-07 04:55:57,972 - Correction Precision: 0.9601200686102229, Recall: 0.8065561959651273, F1-Score: 0.87666405588558
Epoch 31 Training: 100% 250/250 [02:48<00:00,  1.48it/s, loss=0.0141, c_precision=0.974, c_recall=0.844, c_f1_score=0.904]
Epoch 31 Validation: 100% 62/62 [00:22<00:00,  2.71it/s, loss=0.0149, c_precision=0.96, c_recall=0.809, c_f1_score=0.878]
2023-04-07 04:59:37,900 - Correction Precision: 0.96022241231781, Recall: 0.8087175792504291, F1-Score: 0.8779820096714901
Epoch 32 Training: 100% 250/250 [02:45<00:00,  1.51it/s, loss=0.0104, c_precision=0.978, c_recall=0.837, c_f1_score=0.902]
Epoch 32 Validation: 100% 62/62 [00:21<00:00,  2.85it/s, loss=0.0149, c_precision=0.952, c_recall=0.813, c_f1_score=0.877]
2023-04-07 05:03:12,662 - Correction Precision: 0.9515177065763274, Recall: 0.8130403458210328, F1-Score: 0.8768453763481154
Epoch 33 Training: 100% 250/250 [02:45<00:00,  1.51it/s, loss=0.0124, c_precision=0.982, c_recall=0.85, c_f1_score=0.911]
Epoch 33 Validation: 100% 62/62 [00:21<00:00,  2.92it/s, loss=0.0146, c_precision=0.963, c_recall=0.814, c_f1_score=0.882]
2023-04-07 05:06:46,377 - Correction Precision: 0.9633418584821128, Recall: 0.8141210374636837, F1-Score: 0.8824677855242649
Epoch 34 Training: 100% 250/250 [02:46<00:00,  1.50it/s, loss=0.011, c_precision=0.978, c_recall=0.851, c_f1_score=0.91]
Epoch 34 Validation: 100% 62/62 [00:22<00:00,  2.78it/s, loss=0.0145, c_precision=0.97, c_recall=0.814, c_f1_score=0.885]
2023-04-07 05:10:23,368 - Correction Precision: 0.9695278969952921, Recall: 0.8137608069161334, F1-Score: 0.8848413626057009
Epoch 35 Training: 100% 250/250 [02:45<00:00,  1.51it/s, loss=0.00513, c_precision=0.973, c_recall=0.848, c_f1_score=0.906]
Epoch 35 Validation: 100% 62/62 [00:22<00:00,  2.80it/s, loss=0.0144, c_precision=0.96, c_recall=0.818, c_f1_score=0.883]
2023-04-07 05:13:58,870 - Correction Precision: 0.9602536997881775, Recall: 0.818083573486737, F1-Score: 0.8834857026734413
Epoch 36 Training: 100% 250/250 [02:41<00:00,  1.55it/s, loss=0.00933, c_precision=0.971, c_recall=0.845, c_f1_score=0.904]
Epoch 36 Validation: 100% 62/62 [00:21<00:00,  2.91it/s, loss=0.0143, c_precision=0.966, c_recall=0.813, c_f1_score=0.883]
2023-04-07 05:17:28,688 - Correction Precision: 0.9661959777488377, Recall: 0.8134005763685831, F1-Score: 0.8832388025543867
Epoch 37 Training: 100% 250/250 [02:43<00:00,  1.53it/s, loss=0.0126, c_precision=0.978, c_recall=0.849, c_f1_score=0.909]
Epoch 37 Validation: 100% 62/62 [00:21<00:00,  2.94it/s, loss=0.0141, c_precision=0.959, c_recall=0.825, c_f1_score=0.887]
2023-04-07 05:21:00,196 - Correction Precision: 0.9589614740364494, Recall: 0.8249279538901928, F1-Score: 0.8869093720818749
Epoch 38 Training: 100% 250/250 [02:40<00:00,  1.56it/s, loss=0.0129, c_precision=0.981, c_recall=0.841, c_f1_score=0.906]
Epoch 38 Validation: 100% 62/62 [00:21<00:00,  2.93it/s, loss=0.0139, c_precision=0.969, c_recall=0.82, c_f1_score=0.888]
2023-04-07 05:24:29,187 - Correction Precision: 0.9693225394116023, Recall: 0.8195244956769382, F1-Score: 0.8881514732490113
Epoch 39 Training: 100% 250/250 [02:40<00:00,  1.55it/s, loss=0.00966, c_precision=0.975, c_recall=0.853, c_f1_score=0.91]
Epoch 39 Validation: 100% 62/62 [00:20<00:00,  3.04it/s, loss=0.0137, c_precision=0.958, c_recall=0.825, c_f1_score=0.887]
2023-04-07 05:27:57,518 - Correction Precision: 0.9581589958154987, Recall: 0.8249279538901928, F1-Score: 0.8865660080196763
Eval情况：到了62.71，也够牛逼的
Character-level Detect Acc: 0.9859, P: 0.6337, R: 0.7653, F1: 0.6933
Character-level Correct Acc: 0.9852, P: 0.6235, R: 0.7326, F1: 0.6736
Sentence-level Detect Acc: 0.6664, P: 0.6812, R: 0.6044, F1: 0.6405
Sentence-level Correct Acc: 0.6573, P: 0.6745, R: 0.5860, F1: 0.6271


模型：MacBert, 使用macbert作为backbone，macbert的head。加入了FocalLoss中的难易样本的权重。使用了orthogonal_初始化head，其中参数为gain=1。对输出进行了改造，如果该字没错，则固定输出的softmax的index为1，否则softmax就正常输出所在的index。bert的输出融合了一开始的embedding数据，即last_hidden_state += token_embeddings。对token_embedding增加了遗忘门后再加，遗忘门权重只使用了token_emebdding来计算。使用bf16混合精度。增加了SWA。StochasticWeightAveraging(swa_lrs=2e-5, swa_epoch_start=10)
增加了6个维度的pinyin embedding
执行情况：最好的居然能到89.5，牛逼啊
2023-04-07 08:09:35,604 - NumExpr defaulting to 2 threads.
Epoch 0 Training: 100% 250/250 [02:49<00:00,  1.48it/s, loss=0.0794, c_precision=0.976, c_recall=0.276, c_f1_score=0.431]
Epoch 0 Validation: 100% 62/62 [00:29<00:00,  2.13it/s, loss=0.0759, c_precision=0.981, c_recall=0.302, c_f1_score=0.461]
2023-04-07 08:13:20,882 - Correction Precision: 0.9813084112138069, Recall: 0.301507537688334, F1-Score: 0.46128500787739113
Epoch 1 Training: 100% 250/250 [03:15<00:00,  1.28it/s, loss=0.0688, c_precision=0.969, c_recall=0.386, c_f1_score=0.552]
Epoch 1 Validation: 100% 62/62 [00:28<00:00,  2.15it/s, loss=0.0552, c_precision=0.956, c_recall=0.443, c_f1_score=0.605]
2023-04-07 08:18:45,054 - Correction Precision: 0.9558481797049141, Recall: 0.4429289303659573, F1-Score: 0.6053470684901621
Epoch 2 Training: 100% 250/250 [03:14<00:00,  1.29it/s, loss=0.0416, c_precision=0.958, c_recall=0.485, c_f1_score=0.644]
Epoch 2 Validation: 100% 62/62 [00:29<00:00,  2.09it/s, loss=0.0428, c_precision=0.965, c_recall=0.527, c_f1_score=0.682]
2023-04-07 08:22:57,162 - Correction Precision: 0.9651545036154076, Recall: 0.5269203158648503, F1-Score: 0.681680983986744
Epoch 3 Training: 100% 250/250 [03:13<00:00,  1.29it/s, loss=0.0476, c_precision=0.944, c_recall=0.541, c_f1_score=0.687]
Epoch 3 Validation: 100% 62/62 [00:30<00:00,  2.03it/s, loss=0.0347, c_precision=0.961, c_recall=0.59, c_f1_score=0.732]
2023-04-07 08:27:09,492 - Correction Precision: 0.9614260666271411, Recall: 0.5904522613063208, F1-Score: 0.7315988432018068
Epoch 4 Training: 100% 250/250 [03:20<00:00,  1.25it/s, loss=0.0247, c_precision=0.938, c_recall=0.6, c_f1_score=0.732]
Epoch 4 Validation: 100% 62/62 [00:27<00:00,  2.24it/s, loss=0.0301, c_precision=0.967, c_recall=0.623, c_f1_score=0.758]
2023-04-07 08:31:25,501 - Correction Precision: 0.9671125975468411, Recall: 0.6227566403443565, F1-Score: 0.7576419209205055
Epoch 5 Training: 100% 250/250 [03:11<00:00,  1.30it/s, loss=0.0279, c_precision=0.952, c_recall=0.619, c_f1_score=0.75]
Epoch 5 Validation: 100% 62/62 [00:28<00:00,  2.15it/s, loss=0.0266, c_precision=0.955, c_recall=0.669, c_f1_score=0.787]
2023-04-07 08:35:35,396 - Correction Precision: 0.9549411162309499, Recall: 0.6694185211770749, F1-Score: 0.7870858826128163
Epoch 6 Training: 100% 250/250 [03:08<00:00,  1.32it/s, loss=0.0293, c_precision=0.948, c_recall=0.667, c_f1_score=0.783]
Epoch 6 Validation: 100% 62/62 [00:29<00:00,  2.13it/s, loss=0.024, c_precision=0.943, c_recall=0.697, c_f1_score=0.801]
2023-04-07 08:39:42,205 - Correction Precision: 0.9427184466014841, Recall: 0.6970567121318388, F1-Score: 0.8014857609636359
Epoch 7 Training: 100% 250/250 [03:10<00:00,  1.31it/s, loss=0.0246, c_precision=0.937, c_recall=0.675, c_f1_score=0.785]
Epoch 7 Validation: 100% 62/62 [00:27<00:00,  2.28it/s, loss=0.0224, c_precision=0.97, c_recall=0.689, c_f1_score=0.806]
2023-04-07 08:43:47,441 - Correction Precision: 0.96969696969648, Recall: 0.6891600861447634, F1-Score: 0.8057070914149269
Epoch 8 Training: 100% 250/250 [03:10<00:00,  1.31it/s, loss=0.0384, c_precision=0.939, c_recall=0.684, c_f1_score=0.791]
Epoch 8 Validation: 100% 62/62 [00:28<00:00,  2.16it/s, loss=0.0206, c_precision=0.952, c_recall=0.728, c_f1_score=0.825]
2023-04-07 08:47:54,702 - Correction Precision: 0.952112676055891, Recall: 0.7279253409904064, F1-Score: 0.8250610247323269
Epoch 9 Training:   0% 0/250 [00:00<?, ?it/s]Swapping scheduler `PlateauScheduler` for `SWALR`
Epoch 9 Training: 100% 250/250 [03:10<00:00,  1.31it/s, loss=0.0192, c_precision=0.947, c_recall=0.702, c_f1_score=0.807]
Epoch 9 Validation: 100% 62/62 [00:28<00:00,  2.20it/s, loss=0.0195, c_precision=0.95, c_recall=0.736, c_f1_score=0.829]
2023-04-07 08:52:00,776 - Correction Precision: 0.9503940658317337, Recall: 0.7358219669774818, F1-Score: 0.8294557955830187
Epoch 10 Training: 100% 250/250 [03:10<00:00,  1.31it/s, loss=0.0169, c_precision=0.941, c_recall=0.722, c_f1_score=0.817]
Epoch 10 Validation: 100% 62/62 [00:26<00:00,  2.32it/s, loss=0.019, c_precision=0.965, c_recall=0.733, c_f1_score=0.833]
2023-04-07 08:56:05,627 - Correction Precision: 0.9654846335692835, Recall: 0.7329504666185452, F1-Score: 0.8332993261770592
Epoch 11 Training: 100% 250/250 [03:10<00:00,  1.31it/s, loss=0.0208, c_precision=0.947, c_recall=0.734, c_f1_score=0.827]
Epoch 11 Validation: 100% 62/62 [00:28<00:00,  2.18it/s, loss=0.0174, c_precision=0.953, c_recall=0.759, c_f1_score=0.845]
2023-04-07 09:00:13,188 - Correction Precision: 0.9526813880121889, Recall: 0.7587939698489738, F1-Score: 0.844755244261324
Epoch 12 Training: 100% 250/250 [03:06<00:00,  1.34it/s, loss=0.0234, c_precision=0.943, c_recall=0.72, c_f1_score=0.816]
Epoch 12 Validation: 100% 62/62 [00:27<00:00,  2.28it/s, loss=0.0168, c_precision=0.956, c_recall=0.763, c_f1_score=0.849]
2023-04-07 09:04:14,003 - Correction Precision: 0.9563652721543157, Recall: 0.7631012203873786, F1-Score: 0.8488720298513559
Epoch 13 Training: 100% 250/250 [03:07<00:00,  1.33it/s, loss=0.0154, c_precision=0.953, c_recall=0.741, c_f1_score=0.834]
Epoch 13 Validation: 100% 62/62 [00:27<00:00,  2.25it/s, loss=0.0161, c_precision=0.957, c_recall=0.776, c_f1_score=0.857]
2023-04-07 09:08:16,698 - Correction Precision: 0.9570606463032505, Recall: 0.776022972002593, F1-Score: 0.8570862234892588
Epoch 14 Training: 100% 250/250 [03:08<00:00,  1.33it/s, loss=0.0189, c_precision=0.952, c_recall=0.743, c_f1_score=0.834]
Epoch 14 Validation: 100% 62/62 [00:26<00:00,  2.31it/s, loss=0.0156, c_precision=0.959, c_recall=0.782, c_f1_score=0.861]
2023-04-07 09:12:20,265 - Correction Precision: 0.9586449626040657, Recall: 0.782124910265333, F1-Score: 0.861435065723421
Epoch 15 Training: 100% 250/250 [03:09<00:00,  1.32it/s, loss=0.0182, c_precision=0.952, c_recall=0.759, c_f1_score=0.845]
Epoch 15 Validation: 100% 62/62 [00:26<00:00,  2.30it/s, loss=0.0151, c_precision=0.964, c_recall=0.793, c_f1_score=0.87]
2023-04-07 09:16:24,792 - Correction Precision: 0.9642077695325342, Recall: 0.792893036611345, F1-Score: 0.8701989358841621
Epoch 16 Training: 100% 250/250 [03:09<00:00,  1.32it/s, loss=0.0221, c_precision=0.972, c_recall=0.797, c_f1_score=0.876]
Epoch 16 Validation: 100% 62/62 [00:26<00:00,  2.33it/s, loss=0.0147, c_precision=0.968, c_recall=0.793, c_f1_score=0.872]
2023-04-07 09:20:29,112 - Correction Precision: 0.9680245291279159, Recall: 0.7932519741562121, F1-Score: 0.8719668568728965
Epoch 17 Training: 100% 250/250 [03:09<00:00,  1.32it/s, loss=0.0148, c_precision=0.96, c_recall=0.79, c_f1_score=0.867]
Epoch 17 Validation: 100% 62/62 [00:28<00:00,  2.18it/s, loss=0.0146, c_precision=0.97, c_recall=0.799, c_f1_score=0.876]
2023-04-07 09:24:35,294 - Correction Precision: 0.9695254680013193, Recall: 0.7993539124189522, F1-Score: 0.8762541801062894
Epoch 18 Training: 100% 250/250 [03:05<00:00,  1.34it/s, loss=0.0103, c_precision=0.962, c_recall=0.78, c_f1_score=0.862]
Epoch 18 Validation: 100% 62/62 [00:27<00:00,  2.29it/s, loss=0.0142, c_precision=0.964, c_recall=0.803, c_f1_score=0.876]
2023-04-07 09:28:36,577 - Correction Precision: 0.964208710650727, Recall: 0.8025843503227558, F1-Score: 0.876003917231559
Epoch 19 Training: 100% 250/250 [03:07<00:00,  1.33it/s, loss=0.0149, c_precision=0.972, c_recall=0.786, c_f1_score=0.869]
Epoch 19 Validation: 100% 62/62 [00:26<00:00,  2.35it/s, loss=0.0138, c_precision=0.964, c_recall=0.808, c_f1_score=0.88]
2023-04-07 09:32:37,598 - Correction Precision: 0.9644539614556897, Recall: 0.8083273510406287, F1-Score: 0.879515719089553
Epoch 20 Training: 100% 250/250 [03:07<00:00,  1.33it/s, loss=0.0117, c_precision=0.971, c_recall=0.803, c_f1_score=0.879]
Epoch 20 Validation: 100% 62/62 [00:27<00:00,  2.28it/s, loss=0.0136, c_precision=0.971, c_recall=0.809, c_f1_score=0.883]
2023-04-07 09:36:40,909 - Correction Precision: 0.970714900947041, Recall: 0.8090452261303629, F1-Score: 0.8825371960582047
Epoch 21 Training: 100% 250/250 [03:06<00:00,  1.34it/s, loss=0.00759, c_precision=0.972, c_recall=0.809, c_f1_score=0.883]
Epoch 21 Validation: 100% 62/62 [00:27<00:00,  2.25it/s, loss=0.0134, c_precision=0.976, c_recall=0.804, c_f1_score=0.882]
2023-04-07 09:40:42,356 - Correction Precision: 0.9764500654160592, Recall: 0.8036611629573569, F1-Score: 0.8816696195083016
Epoch 22 Training: 100% 250/250 [03:08<00:00,  1.33it/s, loss=0.00758, c_precision=0.964, c_recall=0.805, c_f1_score=0.877]
Epoch 22 Validation: 100% 62/62 [00:26<00:00,  2.37it/s, loss=0.0132, c_precision=0.972, c_recall=0.811, c_f1_score=0.884]
2023-04-07 09:44:44,358 - Correction Precision: 0.9720309810667074, Recall: 0.8108399138546982, F1-Score: 0.8841487274880854
Epoch 23 Training: 100% 250/250 [03:08<00:00,  1.33it/s, loss=0.00449, c_precision=0.969, c_recall=0.814, c_f1_score=0.885]
Epoch 23 Validation: 100% 62/62 [00:27<00:00,  2.22it/s, loss=0.013, c_precision=0.964, c_recall=0.824, c_f1_score=0.889]
2023-04-07 09:48:49,278 - Correction Precision: 0.9639110365081981, Recall: 0.8244795405596467, F1-Score: 0.8887599143798477
Epoch 24 Training: 100% 250/250 [03:05<00:00,  1.35it/s, loss=0.0138, c_precision=0.977, c_recall=0.82, c_f1_score=0.892]
Epoch 24 Validation: 100% 62/62 [00:27<00:00,  2.27it/s, loss=0.013, c_precision=0.971, c_recall=0.811, c_f1_score=0.884]
2023-04-07 09:52:50,211 - Correction Precision: 0.9707903780064558, Recall: 0.8111988513995653, F1-Score: 0.8838482591829763
Epoch 25 Training: 100% 250/250 [03:00<00:00,  1.38it/s, loss=0.00575, c_precision=0.968, c_recall=0.834, c_f1_score=0.896]
Epoch 25 Validation: 100% 62/62 [00:28<00:00,  2.16it/s, loss=0.0128, c_precision=0.962, c_recall=0.821, c_f1_score=0.886]
2023-04-07 09:56:37,758 - Correction Precision: 0.9621530698061556, Recall: 0.821249102655843, F1-Score: 0.8861347787436764
Epoch 26 Training: 100% 250/250 [03:08<00:00,  1.32it/s, loss=0.0126, c_precision=0.977, c_recall=0.835, c_f1_score=0.901]
Epoch 26 Validation: 100% 62/62 [00:27<00:00,  2.29it/s, loss=0.0127, c_precision=0.976, c_recall=0.814, c_f1_score=0.887]
2023-04-07 10:00:41,487 - Correction Precision: 0.9758932414976428, Recall: 0.8137114142136347, F1-Score: 0.8874535129114708
Epoch 27 Training: 100% 250/250 [03:10<00:00,  1.31it/s, loss=0.0215, c_precision=0.982, c_recall=0.826, c_f1_score=0.897]
Epoch 27 Validation: 100% 62/62 [00:27<00:00,  2.28it/s, loss=0.0124, c_precision=0.975, c_recall=0.824, c_f1_score=0.893]
2023-04-07 10:04:46,557 - Correction Precision: 0.9749362786741823, Recall: 0.8237616654699125, F1-Score: 0.8929961084526008
Epoch 28 Training: 100% 250/250 [03:07<00:00,  1.33it/s, loss=0.00266, c_precision=0.974, c_recall=0.834, c_f1_score=0.899]
Epoch 28 Validation: 100% 62/62 [00:27<00:00,  2.26it/s, loss=0.0125, c_precision=0.975, c_recall=0.819, c_f1_score=0.89]
2023-04-07 10:08:50,479 - Correction Precision: 0.9747863247859082, Recall: 0.8187365398417736, F1-Score: 0.889972687759388
Epoch 29 Training: 100% 250/250 [03:06<00:00,  1.34it/s, loss=0.00578, c_precision=0.976, c_recall=0.846, c_f1_score=0.906]
Epoch 29 Validation: 100% 62/62 [00:28<00:00,  2.20it/s, loss=0.0124, c_precision=0.967, c_recall=0.823, c_f1_score=0.889]
2023-04-07 10:12:43,277 - Correction Precision: 0.9670886075945286, Recall: 0.8226848528353113, F1-Score: 0.8890612873229254
Epoch 30 Training: 100% 250/250 [03:10<00:00,  1.31it/s, loss=0.00717, c_precision=0.969, c_recall=0.816, c_f1_score=0.886]
Epoch 30 Validation: 100% 62/62 [00:27<00:00,  2.22it/s, loss=0.0121, c_precision=0.971, c_recall=0.822, c_f1_score=0.89]
2023-04-07 10:16:50,714 - Correction Precision: 0.971162001695941, Recall: 0.8219669777455771, F1-Score: 0.8903576977923843
Epoch 31 Training: 100% 250/250 [03:14<00:00,  1.29it/s, loss=0.00505, c_precision=0.979, c_recall=0.838, c_f1_score=0.903]
Epoch 31 Validation: 100% 62/62 [00:28<00:00,  2.18it/s, loss=0.0121, c_precision=0.969, c_recall=0.826, c_f1_score=0.892]
2023-04-07 10:21:01,251 - Correction Precision: 0.9688552188548111, Recall: 0.826274228283982, F1-Score: 0.8919023629278378
Epoch 32 Training: 100% 250/250 [03:04<00:00,  1.36it/s, loss=0.00698, c_precision=0.975, c_recall=0.832, c_f1_score=0.898]
Epoch 32 Validation: 100% 62/62 [00:25<00:00,  2.39it/s, loss=0.0119, c_precision=0.972, c_recall=0.826, c_f1_score=0.893]
2023-04-07 10:24:49,682 - Correction Precision: 0.9721283783779678, Recall: 0.826274228283982, F1-Score: 0.8932867670621194
Epoch 33 Training: 100% 250/250 [03:10<00:00,  1.32it/s, loss=0.0167, c_precision=0.974, c_recall=0.851, c_f1_score=0.909]
Epoch 33 Validation: 100% 62/62 [00:26<00:00,  2.31it/s, loss=0.0118, c_precision=0.975, c_recall=0.826, c_f1_score=0.894]
2023-04-07 10:28:54,719 - Correction Precision: 0.9745870393896762, Recall: 0.8259152907391148, F1-Score: 0.8941130750810682
Epoch 34 Training: 100% 250/250 [03:08<00:00,  1.33it/s, loss=0.011, c_precision=0.976, c_recall=0.829, c_f1_score=0.897]
Epoch 34 Validation: 100% 62/62 [00:28<00:00,  2.20it/s, loss=0.0117, c_precision=0.968, c_recall=0.834, c_f1_score=0.896]
2023-04-07 10:32:59,121 - Correction Precision: 0.9683333333329298, Recall: 0.8341708542710574, F1-Score: 0.8962591587773954
Epoch 35 Training: 100% 250/250 [03:08<00:00,  1.33it/s, loss=0.00917, c_precision=0.975, c_recall=0.852, c_f1_score=0.909]
Epoch 35 Validation: 100% 62/62 [00:27<00:00,  2.26it/s, loss=0.0118, c_precision=0.974, c_recall=0.826, c_f1_score=0.894]
2023-04-07 10:37:02,072 - Correction Precision: 0.9737510584246513, Recall: 0.8255563531942478, F1-Score: 0.8935508930539381
Epoch 36 Training: 100% 250/250 [03:05<00:00,  1.35it/s, loss=0.00859, c_precision=0.976, c_recall=0.859, c_f1_score=0.914]
Epoch 36 Validation: 100% 62/62 [00:26<00:00,  2.38it/s, loss=0.0117, c_precision=0.975, c_recall=0.829, c_f1_score=0.896]
2023-04-07 10:40:52,016 - Correction Precision: 0.974672857745473, Recall: 0.8287867910980514, F1-Score: 0.8958292914524877
Epoch 37 Training: 100% 250/250 [03:06<00:00,  1.34it/s, loss=0.00417, c_precision=0.982, c_recall=0.862, c_f1_score=0.918]
Epoch 37 Validation: 100% 62/62 [00:27<00:00,  2.27it/s, loss=0.0116, c_precision=0.975, c_recall=0.828, c_f1_score=0.896]
2023-04-07 10:44:54,617 - Correction Precision: 0.9754653130283522, Recall: 0.8277099784634502, F1-Score: 0.8955339800855336
Epoch 38 Training: 100% 250/250 [03:05<00:00,  1.35it/s, loss=0.00845, c_precision=0.982, c_recall=0.855, c_f1_score=0.914]
Epoch 38 Validation: 100% 62/62 [00:27<00:00,  2.23it/s, loss=0.0115, c_precision=0.976, c_recall=0.832, c_f1_score=0.898]
2023-04-07 10:48:56,371 - Correction Precision: 0.9760101010096902, Recall: 0.8323761665467221, F1-Score: 0.8984889572711131
Epoch 39 Training: 100% 250/250 [03:06<00:00,  1.34it/s, loss=0.0114, c_precision=0.978, c_recall=0.843, c_f1_score=0.906]
Epoch 39 Validation: 100% 62/62 [00:26<00:00,  2.33it/s, loss=0.0115, c_precision=0.979, c_recall=0.82, c_f1_score=0.892]
2023-04-07 10:52:56,907 - Correction Precision: 0.9789969995709478, Recall: 0.8198133524763748, F1-Score: 0.8923617889155614
Eval情况：居然只用8000条Wang271K数据的情况下就能到66.87，厉害啊，马飞
Character-level Detect Acc: 0.9883, P: 0.7021, R: 0.7610, F1: 0.7304
Character-level Correct Acc: 0.9874, P: 0.6903, R: 0.7198, F1: 0.7047
Sentence-level Detect Acc: 0.7145, P: 0.7430, R: 0.6414, F1: 0.6885
Sentence-level Correct Acc: 0.7009, P: 0.7345, R: 0.6137, F1: 0.6687
全量训练情况：
2023-04-12 06:16:45,068 - NumExpr defaulting to 2 threads.
Epoch 0 Training: 100% 8055/8055 [1:08:20<00:00,  1.96it/s, loss=0.0058, c_precision=0.949, c_recall=0.752, c_f1_score=0.839]
Epoch 0 Validation: 100% 424/424 [02:51<00:00,  2.77it/s, loss=0.0168, c_precision=0.963, c_recall=0.755, c_f1_score=0.846]
2023-04-12 07:28:27,143 - val_loss 0.01679, Correction Precision: 0.9633741026322146, Recall: 0.7546865236408689, F1-Score: 0.8463559910980774
Epoch 1 Training: 100% 8055/8055 [1:07:48<00:00,  1.98it/s, loss=0.00191, c_precision=0.952, c_recall=0.817, c_f1_score=0.879]
Epoch 1 Validation: 100% 424/424 [02:44<00:00,  3.19it/s, loss=0.0109, c_precision=0.971, c_recall=0.816, c_f1_score=0.887]
2023-04-12 08:40:13,728 - val_loss 0.01089, Correction Precision: 0.9712886022571641, Recall: 0.8156113309726716, F1-Score: 0.8866685531408804
Epoch 2 Training: 100% 8055/8055 [1:06:59<00:00,  2.00it/s, loss=0.00169, c_precision=0.958, c_recall=0.847, c_f1_score=0.899]
Epoch 2 Validation: 100% 424/424 [02:44<00:00,  2.29it/s, loss=0.00909, c_precision=0.962, c_recall=0.848, c_f1_score=0.902]
2023-04-12 09:50:25,907 - val_loss 0.00909, Correction Precision: 0.9624837528062765, Recall: 0.8483128514892289, F1-Score: 0.9017990584557156
Epoch 3 Training: 100% 8055/8055 [1:05:41<00:00,  2.04it/s, loss=0.00111, c_precision=0.969, c_recall=0.874, c_f1_score=0.919]
Epoch 3 Validation: 100% 424/424 [02:40<00:00,  2.49it/s, loss=0.00829, c_precision=0.958, c_recall=0.866, c_f1_score=0.909]
2023-04-12 10:59:16,438 - val_loss 0.00829, Correction Precision: 0.9576710435383, Recall: 0.865913351385083, F1-Score: 0.9094837010982408
Epoch 4 Training: 100% 8055/8055 [1:05:07<00:00,  2.06it/s, loss=0.000875, c_precision=0.968, c_recall=0.883, c_f1_score=0.923]
Epoch 4 Validation: 100% 424/424 [02:41<00:00,  2.63it/s, loss=0.00792, c_precision=0.963, c_recall=0.869, c_f1_score=0.913]
2023-04-12 12:07:33,928 - val_loss 0.00792, Correction Precision: 0.9625569722494107, Recall: 0.8687773380545267, F1-Score: 0.9132660038256446
Epoch 5 Training: 100% 8055/8055 [1:05:04<00:00,  2.06it/s, loss=0.00082, c_precision=0.971, c_recall=0.904, c_f1_score=0.936]
Epoch 5 Validation: 100% 424/424 [02:38<00:00,  3.23it/s, loss=0.00767, c_precision=0.966, c_recall=0.871, c_f1_score=0.916]
2023-04-12 13:15:44,801 - val_loss 0.00767, Correction Precision: 0.9657142857142299, Recall: 0.8712247448447786, F1-Score: 0.9160393107334444
Epoch 6 Training: 100% 8055/8055 [1:04:15<00:00,  2.09it/s, loss=0.00069, c_precision=0.968, c_recall=0.902, c_f1_score=0.934]
Epoch 6 Validation: 100% 424/424 [02:38<00:00,  3.23it/s, loss=0.0075, c_precision=0.966, c_recall=0.874, c_f1_score=0.918]
2023-04-12 14:23:06,498 - val_loss 0.00750, Correction Precision: 0.9658345795467062, Recall: 0.8744011664236162, F1-Score: 0.9178464056230754
全量训练后：为毛还不如不全量训练啊
Character-level Detect Acc: 0.9870, P: 0.6558, R: 0.7994, F1: 0.7205
Character-level Correct Acc: 0.9865, P: 0.6488, R: 0.7752, F1: 0.7064
Sentence-level Detect Acc: 0.6864, P: 0.7000, R: 0.6340, F1: 0.6654
Sentence-level Correct Acc: 0.6791, P: 0.6950, R: 0.6192, F1: 0.6549
